<!DOCTYPE html>
<html>
<head>
    <title>Sloganizer Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        pre { background: #f4f4f4; padding: 10px; overflow-x: auto; }
        button { padding: 8px 16px; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>Sloganizer Backend Debug</h1>
    
    <div class="section">
        <h2>1. Test Debug Endpoint (No Auth)</h2>
        <button onclick="testDebugEndpoint()">Test Debug Info</button>
        <pre id="debugResult">Click button to test...</pre>
    </div>
    
    <div class="section">
        <h2>2. Test Profile Lookup</h2>
        <input type="text" id="userIdInput" placeholder="Enter User ID" style="width: 300px;" value="76c930b5-850a-4899-a217-6cc769999e98">
        <button onclick="testProfileLookup()">Test Profile</button>
        <pre id="profileResult">Click button to test...</pre>
    </div>
    
    <div class="section">
        <h2>3. Test Network Connectivity</h2>
        <button onclick="testNetworkConnectivity()">Test Network & Stripe Access</button>
        <pre id="networkResult">Click button to test...</pre>
    </div>
    
    <div class="section">
        <h2>4. Test Stripe Price IDs (TEST MODE)</h2>
        <button onclick="testStripePrices()">Test Pro & Agency Prices</button>
        <pre id="stripeResult">Click button to test...</pre>
        <p style="color: orange;"><strong>Note:</strong> Now using TEST mode keys - safe to test!</p>
    </div>
    
    <div class="section">
        <h2>5. Test Supabase Database</h2>
        <button onclick="testSupabaseConnection()">Test Supabase Connection</button>
        <pre id="supabaseResult">Click button to test...</pre>
    </div>

    <script>
        const API_BASE = 'https://sloganixerbackend-production.up.railway.app';
        
        async function testDebugEndpoint() {
            try {
                document.getElementById('debugResult').textContent = 'Loading...';
                const response = await fetch(`${API_BASE}/api/debug`);
                const result = await response.json();
                document.getElementById('debugResult').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('debugResult').textContent = `Error: ${error.message}`;
            }
        }
        
        async function testProfileLookup() {
            try {
                document.getElementById('profileResult').textContent = 'Loading...';
                const userId = document.getElementById('userIdInput').value;
                const response = await fetch(`${API_BASE}/api/payments/debug/profile/${userId}`);
                const result = await response.json();
                document.getElementById('profileResult').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('profileResult').textContent = `Error: ${error.message}`;
            }
        }
        
        async function testNetworkConnectivity() {
            try {
                document.getElementById('networkResult').textContent = 'Loading...';
                
                const response = await fetch(`${API_BASE}/api/debug/network`);
                const result = await response.json();
                
                document.getElementById('networkResult').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('networkResult').textContent = `Error: ${error.message}`;
            }
        }
        
        async function testStripePrices() {
            try {
                document.getElementById('stripeResult').textContent = 'Loading...';
                
                const response = await fetch(`${API_BASE}/api/debug/stripe-test`);
                const result = await response.json();
                
                document.getElementById('stripeResult').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('stripeResult').textContent = `Error: ${error.message}`;
            }
        }
        
        async function testSupabaseConnection() {
            try {
                document.getElementById('supabaseResult').textContent = 'Loading...';
                
                // Load Supabase client
                const { createClient } = await import('https://cdn.skypack.dev/@supabase/supabase-js');
                
                const supabaseUrl = 'https://iupkzztkfayshybpujfw.supabase.co';
                const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml1cGt6enRrZmF5c2h5YnB1amZ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4Njc1MzcsImV4cCI6MjA3MDQ0MzUzN30.V3rBi2GYpzM6iWJUEcufYSNHMUxQ6p10ifto-sYp6Y8';
                
                const supabase = createClient(supabaseUrl, supabaseKey);
                
                // Test database connection
                const { data: tables, error: tablesError } = await supabase
                    .from('profiles')
                    .select('*')
                    .limit(1);
                
                const result = {
                    connected: !tablesError,
                    tablesError: tablesError?.message,
                    sampleData: tables
                };
                
                document.getElementById('supabaseResult').textContent = JSON.stringify(result, null, 2);
                
            } catch (error) {
                document.getElementById('supabaseResult').textContent = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>